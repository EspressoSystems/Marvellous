load("instance_generator.sage")

##########################################################
## rescue381 parameters
##########################################################
## use rescue381 to check the correctness of key_injection function

q761 = 258664426012969094010652733694893533536393512754914660539884262666720468348340822774968888139573360124440321458177
rescue381 = Rescue(128, q761, 4, 5)

##########################################################
## print parameters
##########################################################
import sys
def convert_bytes(input):
	res = []
	for v in input:
		res.append(int(v))

	res_str = "["

	for v in res:
		res_str +="0x%02X," % v

	res_str += "],"
	res_str = res_str.replace(",]", "]")

	return res_str
print("==========================\n")

for v in rescue381.constants_matrix:
    for e in v:
        print(convert_bytes(int.to_bytes(int(e), 48, 'little')))

print("==========================\n")
print("init vector")
for e in rescue381.initial_constant:
	print(convert_bytes(int.to_bytes(int(ZZ(e[0])), 48, 'little')))


def key_injection(init_vec, key_sched_matrix, key_sched_vec, q):
    key_injection = []
    k = (init_vec * key_sched_matrix + key_sched_vec) % q
    key_injection.append(k)
    for i in range(1, 24):
        k = (key_injection[i-1] * key_sched_matrix + key_sched_vec) % q
        key_injection.append(k)
    return key_injection


init_vec_381 = vector([ZZ(e[0]) for e in rescue381.initial_constant])
key_sched_vec_381 = vector([ZZ(e[0]) for e in rescue381.constants_constant])


key_sched_matrix_381 = matrix(ZZ, 4, 4)
for i in range(4):
	for j in range(4):
		key_sched_matrix_381[i,j] = ZZ(rescue381.constants_matrix[i][j])
key_sched_matrix_381 = key_sched_matrix_381.transpose()

key_injection_381 = key_injection(init_vec_381, key_sched_matrix_381, key_sched_vec_381, q381)

print("==========================\n")
print("key injection")
for e in key_injection_381:
    print("[")
    for f in e:
        print(convert_bytes(int.to_bytes(int(f), 48, 'little')))
    print("],")
print("==========================\n")
#
permutation_round_key = []
permutation_round_key.append(0x0080EA7C355E8E18A08C0C8BE9FCD5DBF3728FA188451F70E0B959A2F8CF3986501D9BA7D8C81711A83E5CEBF7E6A301)
permutation_round_key.append(0x01280CCA38FFF3FC34C6202882982ABA2D8074E748EE7A73B7DC9D5E2956ABCBBA12E820CB839188AD01581D48CB8CB3)
permutation_round_key.append(0x0046F985E82B873FFF8E83CEA2DCE0B5FFB58A70C6BCB1EFE4E7DAF255107D96134429B6053E27658AB9D26626951510)
permutation_round_key.append(0x004AE71F3383B38CBB4AB8733101B8CB172691A3557A78FAB45F399BF0572BC6B8B9402092AE80DED9A113DA63B8E153)
permutation_round_key.append(0x015642EF632393D774C64DBF5F2C176FE104245020E781B143ECA3D24863737C650CB247ABD6BDC9B0AC491B9C202C77)
permutation_round_key.append(0x018BEC37689AE2E38906CCF24B298748E245B1520A3EF6C331BA88562EC6EFE7636B70412896CA77E1288B7BAE76BF14)
permutation_round_key.append(0x015200AA480CBE0871F7AD38D5B4E23E7A971A2D4B53D763D0D8AE791BB28C32D502EE2A23A5F4A11CFF2AFD74D5BAB7)
permutation_round_key.append(0x00F10852AB7CEE002118F797C1AD946D15525ED65C9B9A29DD799C0D556C2494B24F7283797C9EA93E21902FD7A11448)
permutation_round_key.append(0x01A994D9A20497BC33D367960F18F7A2A361FFCB42A382FFA90F8C9592D7733EACBEC7A45BDE9550E65084EAC4391178)
permutation_round_key.append(0x005271F90D165382B7204CA5C8C143A6F0454059D5BE4A9A9239FACFF6B7FD6A2F11F1B3647FB628B4B3DC721D6995C7)
permutation_round_key.append(0x01A898D61ABB7F777BDC4C80F8E24F767E5C2A52A2E1EF67098A19A82002B7FD6B03C3A12329D6A8ECB5588CBFB65BA5)
permutation_round_key.append(0x01352994DBEC33719D2DC7170FA1D9C7199960825E6106FE67DC24CE45ECFCDF67F4B91DDAA1F7D4B8BF846DD550FDFC)
permutation_round_key.append(0x010052774FBEE0009BEDC61B1ADEFA5C5082FECEAC3E1A08541766D790BA504D3EAC761960844C255246DA347834788E)
permutation_round_key.append(0x0178F157CE75B6C67FDDB6773406E7F05803CD69321EFF77990A2046B27575A36707589BD04A4AF59483F1C40A034FC1)
permutation_round_key.append(0x004D956FEFA4B197B3EAAC3107BA1E3FC6DF205F79F2E0EF3E7A10A1803584751040E1575B277E1DA8079538E13DEDE8)
permutation_round_key.append(0x000569569FF83C7871384CB663DFD3C60253E71E3055C876847C050EB56317C894ABCD70051A1ECBA108C6B6186B73CF)
permutation_round_key.append(0x017A6924B81C114AD58BD6B1596F7EA583257F24C88B4287F6AAB5EB395E703E2FFD16536814FC0DFFA43ED6E1041225)
permutation_round_key.append(0x0151CA73C0C2B183331E6D531F42EC9E3A7D35ED8E1D4F89A47C7E4797EFB9DFA7C57DECCB52D48643948F830FE2E96D)
permutation_round_key.append(0x00512368E63C0D9AE55B2D36C5E9F78CBE310D70B533BC446F603C1923DA1425C859859652910B2D918C123E5EDBC69E)
permutation_round_key.append(0x0023978F14890726B17EDE30B71C9344CA442B53578E3E319009CA96CB1908CC68803642843FBEDFA6DED97D8810205E)
permutation_round_key.append(0x006FCFAA2484F8C997D1C540F5D7FDB54281FEF03A3AA8CFA83D73123FD6666CAF584B118AEC2A2D2FA534756EABE145)
permutation_round_key.append(0x008E745EAECB5ACEAA6804F05A943894EFF31B127A742048079383096B8BA53A1EFC7874DE663B975F37FDEE18491BD1)
permutation_round_key.append(0x00F4EF976809DBA12AC486608151B69667BB267E9C433EE2B88FC4B484C2DA1A2A7FDF61526BB3A59C7065D393E4D350)
permutation_round_key.append(0x009822DA2F30FF21D39FB052914320F07FCF76D08D9FBBAC055CBED167FA563E90DEFFD04BE873B9783AD83463765348)
permutation_round_key.append(0x00AB49E44ADEC5FD8B706DE2A27E38307D4FBADBF75B8D872531B3FA4CFE7A93D95AC1094929BEAFDDBD417C0EA02A1C)
permutation_round_key.append(0x01274814311CBEA505E2EA4432D8A60D0CBADA1125476BCFDD9C7784CCE7258089A1BD050C9C845B216FCA8CFE26610C)
permutation_round_key.append(0x00E16D3D37DAEC911C869B6CCE937BE5A14D61055033D3892BCD5AB2950E2AC86E42A903871D85C68CDD2BD60A7B8A26)
permutation_round_key.append(0x0053B1788BA03F90278F77E0D5EC4BF2025106CFFF05AA81FDDB2EAEA8DFB1F7315DC6B5035F347CEC1F215746D7472A)
permutation_round_key.append(0x01A16050F00C1DF461F3A6809AAB68FDC9662E1C83753CC9DB7F75E608D49AD96E947925A88D6501E2E0B43AF96BAEF6)
permutation_round_key.append(0x019E536D01742116626816A64E405FAE1643D4C46F015D58C6363DFCE0689A634763A5B41827FD1CB0F81E834D345BC6)
permutation_round_key.append(0x013570C4C75D2955822CBF087EF37147C182427D2095F42A7CC0C1F6A43EE2F3C2BC3E293230D4CA7056A6AE5EC86353)
permutation_round_key.append(0x00DDB26B71E4C9E80A32D805DF4EF3D728E43DB6EA1346DE63B994D5747F7A091F7E6B650643446385B0A5343B94B428)
permutation_round_key.append(0x007A6601DEC29C73BC104EBD04185B3F61269565CE450CE35566DAE284DA58FDEC5FDDC0A982C3DAEFB81865D5794102)
permutation_round_key.append(0x00811C11CB02C62A311BE79781AC5AB47E764074644BD9A459417FB489B92FB1FC3A794EF7396B72E156D670081BD116)
permutation_round_key.append(0x0027D8D4F0D3897BC26DDB0D19BC94CBABD5598B96515E03B444B51C35BC8A8A4A730940BAC8D88F7F63EFAC0919A10B)
permutation_round_key.append(0x00F0D575B1186CD04C0B99FCB4103554C98BBE1A504F568F0EA5AEC88771B2C654A57F2D99B6D579437372DF09CA731B)
permutation_round_key.append(0x008799857BF2D07BB6B14BDD63B6AC89D4097D14344B05440032B31518C81ED6E7EAA27F3A9AD212228FB95521B52A1E)
permutation_round_key.append(0x003E4320EFF297D347977F1B2128E192A6D1F0F31EC0411E739DEE2A264CCBACB9D630A239DCF1ED6594F7682C4C9841)
permutation_round_key.append(0x0155ADCE259F02C00435F4E78BC8157D3163A20F0B15C53DB2D551E8E965C1FDD9A8BCEA42FCB4FB23BB98E9FE6EF9CF)
permutation_round_key.append(0x003E434E09AC8D5847225538B64714F35ACE80883B19E6CA06358C74FC6B411158FD599B7B856BB7F41FACC04AE7CCDE)
permutation_round_key.append(0x0053BC2F43C4B11698BC921B572ACEDF10D52A697FD36C81594511E993A8ACCAC11D0428F97C57FC170DD4CDF77B04D1)
permutation_round_key.append(0x0086752E75CF225465EF7059B10F881CA400B48638F188B4048F8E1C53AE8E8DD2D553F9A7DAD79C6095F18122FA9989)
permutation_round_key.append(0x016EA07C19463DD509B1954CF8461DE9F8886F574AF74E2AB194A040FA172F80B007E99C4523F59EEAF297532C99902A)
permutation_round_key.append(0x016661BEDB501F58AC8E3AC0909944E813223622BC7CE2310265B121E4FED910F1BCDD30F6D6A19B8AA87F2C7BDA87E1)
permutation_round_key.append(0x010787455FA84AA9949E748207DE56FEAAD47B136AECEF1F5A846E9C93F3538F442EAA6B085141FB6D79F591E7926B5A)
permutation_round_key.append(0x0076853D8806F1777ED8AA946E487636C78EF5839A9F00831B90F7FEA7A596687504E9D29992D45C197C4DCCA76B15C3)
permutation_round_key.append(0x016ECF81CCD35C3F692A8EC243578575866E39AD75D1CD704113A4D81023FAD9FDA6559D533EAEF19C7F4BA3FCC8DDC1)
permutation_round_key.append(0x00A088FDE25CEE22FE6504DE910988A8C5838099D5F36E4AB5F400FCD30AEFE9F851198806A33B203DBFBAF25794EEF9)
permutation_round_key.append(0x00B4ADD574CF1A8710A51CABBFCB3BE20B58D57301D4EBB52F754D776B7F603778753F740F849C388D679C7ACCCA4CAD)
permutation_round_key.append(0x015CFFFF86DD17C55D22EFE4D94E9CAC9E5E52A47D6BFBD29F239CE8068E6FE09789E6905E81CD793F193141CF805D26)
permutation_round_key.append(0x016CA1B5C3E26245E23C97D6ED42375F3A1D4BE444C5CFE37B0746BF14B8FD48A25C350C738A58D1A7BF09EAB0A43992)
permutation_round_key.append(0x0160F9A3F683EA244C128E08FF14D6560A3525808EF71A33EED65C96B5F95652F559F5987A8048138C174D7F3F71BFE3)
permutation_round_key.append(0x00DB6306872C5759C8EB4493B119D2C320DC6126D4E05E93B6D37EA899C9CF183583F49BEB32D6AC4807EE2D104428C7)
permutation_round_key.append(0x00FC9F5A4C5F6DE2E285418ABDB0B325B36F8C51B7409938A714E6C41D9D9A562F8ED014D50F056A06B7AF8C0B4B4861)
permutation_round_key.append(0x0027BD52731A6C60580D682BB14772F352E895FCE041CB973D628446CCC531DA4CB9BE5542A744D5D8D72A14F2FD1850)
permutation_round_key.append(0x019891D16D258C628694C0F4DA25EAA8EC2E3605BC7B590DEF120E992FB9020A67A9847DD5D53A6BD90AAECA2D8221C6)
permutation_round_key.append(0x00EB8CE7A1EAAB8986B232B14EAB3B015FA2A8FA4A0C1197DD9F31F27A3876497268BD85D59A1D3B78A9BFB90EBEEF03)
permutation_round_key.append(0x00AE59F742A340720E5B7F27F2390F3A07B6C3B4034900638BBBFBBFDCED5DF8862272B256A3FFABA08FF72B9CD7D9DC)
permutation_round_key.append(0x000BF1ED608937707F12490D11B97D25C163A826540B2CE8C68C5C5FFA6C2765AAFAB98DDAD9AD9EE12412CD060AAE44)
permutation_round_key.append(0x009520B99F3028D17D5F3AD12B738AB1209525901FB465AD2E8C7C31AA65BE056072686A7D1CEA190D9D6B716FBCB3EE)
permutation_round_key.append(0x00E7BCA436E387091736B75D0916BD69942C9206C3160F0ECF43578E006191A1C09E21C6B0860362A533861F7388E1A8)
permutation_round_key.append(0x01199ED1BAA24ED4AA5EF47FC95047F38CFA903AAF445B2DBFDF9732CF5434DAA02889C4038BCEA84B3829247FC4DB54)
permutation_round_key.append(0x0002C9F89F850E83BE5B0D1C829205C23C22BD4D1B35AF829BD85AE546DF2870C1F4BE1AE161F6EF9E95EF1EF881C95D)
permutation_round_key.append(0x008415A0B922F13FC54F2CF78765646F158FEFCA771D38F226D8BA051100D18873DE4D74492EF22A8F50E51CCB76B742)
permutation_round_key.append(0x001AB0EA92922BD2FF0106E715BDEE4BDC3B9F99102B5A80D7E3A3619EF28FAFE3CE6C57EC46CF0C949B766AEE4A3B94)
permutation_round_key.append(0x019D546103718308375695C6C1DC2ED16B847693950D0F5D8543D45645E31A301E07E9D713E270E4E3CB515CFCA26A07)
permutation_round_key.append(0x014EE93268C0CC6C9EC8780BCED2C34786C3195BDE71646BE2DA12A79672B006A71C9B797AF9D9ED5D14D1CA8BDF74D4)
permutation_round_key.append(0x018C703005B340DF9F2C5395B98E2C15B776D1677029D512E7477898BF71CBE738BBCDB262BA22EA1FFBFC333284BCC5)
permutation_round_key.append(0x017081EA2FE252B88F18B5D6903653540E21D026F36F8A253C4E937402E5D6E240E2862C1BAED97823D41F3D4021CD18)
permutation_round_key.append(0x01AC516FF495B21662549444B98239BA5B1B9BFD566110FD2119487581181DA12F9C52BE62220AC18996FD6720906E03)
permutation_round_key.append(0x008A188264F19AE83F4A4942ABAEE52FF180D95CA55C3448A27847A777F5026715F58A66546DB8C5D360C14EB2754C86)
permutation_round_key.append(0x004B656326A6FE401FB87254B231ED4A7AB0AA0A64C4915E3E6E92E913545E651A1FD030135D08CDAF15AB29AA9259F1)
permutation_round_key.append(0x00F6EDF59D46880203E4C70C1F26D0A19170620F3B17368556854297688152BD42A98F46B310D7B502DA5627A2341459)
permutation_round_key.append(0x0121E09822C2C61EAB9C5667B63C5C6662F534F3108B2C02BD1D4939DB74F77CB1DC86FEDF455B3FB34C642A750EE2E6)
permutation_round_key.append(0x002B7F8BF88CD8B0A563C41CD28E6269DFAECCA9D2D6D0AFED6FFF358287BFA7CD5D9175CB7B542957A2A8DB3DABADCF)
permutation_round_key.append(0x0183639428C6BBCA51E4A36D43981EBFE4BADE175C9675C3CDCAE0684881443FA6A10D351C21896454299D1320D54ABF)
permutation_round_key.append(0x00D5102ABFB8A21FF87410151052B1E30D4BB1A392F51C69234E343FB6A68583B8FE3979446FCE06FB4A78A1D6338352)
permutation_round_key.append(0x00824F492D2A4947CD062E712ACC342794959F9A13628E3A70D1C3291B09EB67E1B7F644BF416570E25270A7802471E4)
permutation_round_key.append(0x008C0C386564D842B6C82B1665EAF5969663E74FFE4104BD7E5DDB58A8BEF4A8E0679909D37BBED4B65727F585299B8F)
permutation_round_key.append(0x001211578852D74215FA61730A2690841ACB6FF046899CE7F6D991C410A4C344CCA8810F2B14D361F2DD8652A28A08DB)
permutation_round_key.append(0x015A215CF9B9889344BEDF9409D6D571B50C97E5CB0502D375DBB19380F8BA4214329A77FE949FE26498BE33737F5F7A)
permutation_round_key.append(0x0095E3FA763B43BADE76C824BC2A69EC363B31F696E123BF6C98C77C0D3F3D5BB57143D22BFDF159B2880F6C4E5D6885)
permutation_round_key.append(0x00A6784ACDBB2E4AE70C08F723B3E83DCB07F3767B9DAC610EFA84CAAC94002B26135B73C4DF5DC52543D776140B765E)
permutation_round_key.append(0x001A8280101CF0D87C9946DA9262B7120D55B54BCACE54A80CCAE053285D7BE3D3278B59EB8768BB9D536EAB9B2FC6ED)
permutation_round_key.append(0x0051A0114F359994E895EC9607843C54351B0AB2206D82C3F56ABC207D3F8E277E5DBDAFE668CA995CEB2D10C823F583)
permutation_round_key.append(0x00680F0F9B14F3D5A5CAC66664301E1623B144C93E03FCAD129003B5CADF6B3EEB1DBB581F16BEB425A314C8C64BE543)
permutation_round_key.append(0x0194C04F75B4BEAEA4D3E0EC396B4F97CA4A2026A09ED0CA2E2B271C3B854E050679E05669506B67690B4065C6B40D20)
permutation_round_key.append(0x007554D3C00CA7B5DA8B8745F67FF1198BC548919CFC5658BE42130BAE3069D7F87B92CB1EB4F7261989FADD6840E264)
permutation_round_key.append(0x00D1B75816502D6EEBC69A62082162B4482BA6B71F3CAA9DF14AF5F8C98B9123BE5CDFE6F0F8E54ED15E36FAC8A9C97F)
permutation_round_key.append(0x004580FBBC74EE350F14837AB6117883FF29834F1402874E483E975F12CCD5A0C8F915C44A33FE9042AB1BEE0878A2ED)
permutation_round_key.append(0x0016521295C949E25B7680B619D5203B2857B0CE2BAFC88BC790F3CF3F2BBFC420001D0B1B5ADE6C7B5EE879997D547C)
permutation_round_key.append(0x001D76492FA35562C718B6BB8EE26B9F9B05AEE135B09B2B8F8CF76299C684D7A3B21A36001B682EB59C726D7B4FC5BB)
permutation_round_key.append(0x010BC3A8E29DC3DB4243627578BF94B3A157BAC155862F683514EEEB11C426BFAB79C975AE3A389EDD07B911C21B4E48)
permutation_round_key.append(0x00D0D361069B3AB625C1764571B25E36DDF629AFA765ECC0F9DD845B5BA53AE45A10399ADAAD076CCC65B27B72E172DB)
permutation_round_key.append(0x01162A4B9C9ED82DC75509F9C9DD5E2DB8EDEC817E680F127E0049D615840FB077DDB5D839F38BF2F551A6E45BEEDB18)
permutation_round_key.append(0x00B90FC671CBC724864D8E5B15236053D6CAEB4EF3980E1FC8998E4F10A8CD81537B47E119DB32655BCCDFF07921C8BB)
permutation_round_key.append(0x0047697DDCED8D5C47E178210060D8720017BD12CC8910B8655278AC2B56BF848AA2050F3BD416DD2B6612D8481C90DC)
permutation_round_key.append(0x00260FA4E24BABE311C453F0B223CA33E0475838BBB3AD91B21AD540DF52A3BF84380D3B1E7C839974C0795576C4E55E)
permutation_round_key.append(0x006A346B6F13DFC22781C4C56A26ADAAB11325D9C33CDB1A3098833F22992B9AA135FB57A96D3C8EF498184293031BF7)
permutation_round_key.append(0x005A6754711D2A8FC7EAECC83194F53B888AA92715CEBBBF6CF07E27B8409F18603B9DB6E883F2E9D07E3FD7ACDDF429)


print("permutation round key")
a = ZZ(0)
for i in range(len(permutation_round_key)/4):
	print("[")
	for j in range(4):
		print(convert_bytes(int.to_bytes(int(permutation_round_key[4*i+j]), 48, 'little')))
	print("],")
    # a = a + ZZ(1)
    # if a%4 == 0:
	# 	print("],\n[")

print("==========================\n")
#
#
print("mds")
for e in rescue381.MDS:
    print("[")
    for f in e:
        print(convert_bytes(int.to_bytes(int(f), 48, 'little')))
    print("],")
print("==========================\n")

print("v0")
v0 = rescue381.Sponge([0,0,0,0], 4)
for e in v0:
	print(convert_bytes(int.to_bytes(int(e), 48, 'little')))
